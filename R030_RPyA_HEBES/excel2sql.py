from typing import NoReturn
from openpyxl import load_workbook
from time import sleep
import sql

def insertarExcel(excelpath):
    book = load_workbook(excelpath)
    sheet = book.active
    rows = sheet.rows
    headers = [cell.value for cell in next((rows))]
    all_rows = []
    for row in rows:
        data = {}
        for title, cell in zip(headers,row):
            data[title] = cell.value
        all_rows.append(data)
    sql.TuncateZeus()
    sleep(2)

    for row in all_rows:
        direccion = str().replace("'","")
        sqlQuery = r"Insert into RPyA_MM_HEBES (RPAdo,Canal,TiendaUsuario,IdContrato,Sector,RazonSocial,TipoDocumento,NumeroDocumento,numero_de_telefono_contacto,Email,NumeroTelefono,CodigoPostal,Población,Provincia,Direccion,IdCliente,Idservicio,PaqueteInicial,PaqueteActual,Producto,FechaVenta,FechaCita,FechaInstalación,FechaPreactivación,FechActivación,FechaCancelación,MotivoCancelación,FechaBaja,MotivoBaja,OTInicial,FechaOTInicial,OTActual,NombreOTActual,EstadoOTActual,FechaOTActual,FechaCierreOT,FechaPrevistaPortabilidadVC,FechaPortabilidad,EstadoPortabilidad,OperadorPortabilidad,SegmentoCanal,CanalMaestro,Supercanal,Subcanal,Vendedor,Tiposervicio,Tecnologia,Terminal,TipoMovilInicial,TipoMovilActual,Descuentos,Campaña,Origen,TipoContrato,TipoFactura,Enlinea,TipoPaquete,ICCID,NuevaVenta,TipoVenta,MotivoCancelacionProv,MotivoJira,SubmotivoJira,fax_to_mail,estado_fax_to_mail,fecha_fax_to_mail,office_365,estado_office_365,fecha_office_365,ip_fija,estado_ip_fija,fecha_ip_fija,masbackup,estado_masbackup,fecha_masbackup,maswifi,estado_maswifi,fecha_maswifi,tipo_maswifi,centralita,estado_centralita,centralita_instalación_conjunta,estado_instalación_conjunta_centralita,fecha_portabilidad_fija_centralita,mas_comunica,mas_comunica_fecha,mas_comunica_estado,agile_tv,agile_tv_fecha_activacion,agile_tv_motivo_activacion,agile_tv_fecha_baja,agile_tv_motivo_baja,ultimo_ms_neba,huella,centralita_submotivo_cancelacion,centralita_problema,firma_biometrica)  values ('01','"+str(row['Canal'])+"','"+str(row['Tienda usuario'])+"','"+str(row['Id de contrato'])+"','"+str(row['Sector'])+"','"+str(row['Razón Social'])+"','"+str(row['Tipo de documento'])+"','"+str(row['Número de documento'])+"','"+str(row['Número de teléfono contacto'])+"','"+str(row['Email'])+"', '"+str(row['Número de teléfono'])+"', '"+str(row['Codigo postal'])+"', '"+str(row['Población']).replace("'","")+"', '"+str(row['Provincia'])+"', '"+direccion+"', '"+str(row['Id cliente'])+"', '"+str(row['Id de servicio'])+"', '"+str(row['Paquete inicial'])+"', '"+str(row['Paquete actual'])+"', '"+str(row['Producto'])+"', '"+str(row['Fecha de venta'])+"', '"+str(row['Fecha de cita'])+"', '"+str(row['Fecha de instalación'])+"', '"+str(row['Fecha de preactivación'])+"', '"+str(row['Fecha de activación'])	+"', '"+str(row['Fecha de cancelación'])+"', '"+str(row['Motivo cancelación'])+"', '"+str(row['Fecha de baja'])+"', '"+	str(row['Motivo de baja'])+"', '"+str(row['Ot inicial'])+"', '"+str(row['Fecha ot inicial'])+"', '"+str(row['Ot actual'])+"', '"+str(row['Nombre ot actual'])+"', '"+str(row['Estado ot actual'])+"', '"+str(row['Fecha ot actual'])+"', '"+str(row['Fecha Cierre OT'])+"', '"+str(row['FECHA PREVISTA PORTABILIDAD VC'])+"', '"+str(row['FECHA PORTABILIDAD'])+"', '"+str(row['ESTADO PORTABILIDAD'])+"', '"+str(row['OPERADOR PORTABILIDAD'])+"', '"+str(row['Segmento Canal'])+"', '"+str(row['Canal Maestro'])+"', '"+str(row['Supercanal'])+"', '"+str(row['Subcanal'])+"', '"+str(row['Vendedor'])+"', '"+str(row['Tipo de servicio'])+"', '"+str(row['Tecnologia'])+"', '"+str(row['Terminal'])+"', '"+str(row['Tipo movil inicial'])+"', '"+str(row['Tipo movil actual'])+"', '"+str(row['Descuentos'])+"', '"+str(row['Campaña'])+"', '"+str(row['Origen'])+"', '"+str(row['Tipo contrato'])+"', '"+str(row['TIpo factura'])+"', '"+str(row['Online'])+"', '"+str(row['Tipo de paquete'])+"','"+str(row['ICCID'])+"','"+str(row['Nueva venta'])+"', '"+str(row['Tipo venta'])+"','"+str(row['Motivo cancelacion prov'])+"','"+str(row['Motivo Jira'])+"', '"+str(row['Submotivo Jira'])+"', '"+str(row['Fax to mail'])+"','"+str(row['Estado Fax to mail'])+"','"+str(row['Fecha Fax to mail'])+"','"+str(row['Office 365'])+"','"+str(row['Estado Office 365'])+"','"+str(row['Fecha Office 365'])+"','"+str(row['IP fija'])+"','"+str(row['Estado Ip fija'])+"','"+str(row['Fecha Ip fija'])+"','"+str(row['Masbackup'])+"','"+str(row['Estado Masbackup'])+"','"+str(row['Fecha Masbackup'])+"','"+str(row['MASWIFI'])+"','"+str(row['Estado MASWIFI'])+"','"+str(row['Fecha MASWIFI'])+"','"+str(row['Tipo MASWIFI'])+"','"+str(row['Centralita'])+"','"+str(row['Estado Centralita'])+"','"+str(row['Centralita Instalación Conjunta'])+"','"+str(row['Estado Instalación Conjunta Centralita'])+"','"+str(row['Fecha portabilidad fija centralita'])+"','"+str(row['Mas comunica'])+"','"+str(row['Mas comunica fecha'])+"','"+str(row['Mas comunica estado'])+"','"+str(row['Agile Tv'])+"','"+str(row['Agile Tv Fecha Activacion'])+"','"+str(row['AGILE TV MOTIVO ACTIVACION'])+"','"+str(row['Agile Tv Fecha Baja'])+"','"+str(row['Agile Tv Motivo Baja'])+"','"+str(row['Ultimo Ms NEBA'])+"','"+str(row['Huella'])+"','"+str(row['CENTRALITA SUBMOTIVO CANCELACION'])+"','"+str(row['CENTRALITA PROBLEMA'])+"','"+str(row['FIRMA BIOMETRICA'])+"')"
        print(sqlQuery)
        sql.InsertZeus(sqlQuery)
        print('Insertado')